# Nested loop join
두 테이블을 결합하는데 사용되는 가장 간단한 형태의 조인 알고리즘.
쿼리 구조와 데이터 분포를 고려하여 선택됨.
## 동작 방식
1. 외부 반복문(Outer Loop) 1
	- 외부 테이블(기본적으로 작은 테이블)의 각 행을 기준으로 내부 반복문을 실행한다.
2. 내부 반복문(Inner Loop) M
	- 내부 테이블(기본적으로 큰 테이블)의 모든 행을 반복하여 외부 반복문의 각 행과 비교한다.
	- 외부 반복문의 각 행에 대해 내부 테이블의 모든 행을 순회하며 일치하는 행을 찾는다.
3. 조인 조건 검사
	- 외부 반복문의 각 행과 내부 반복문의 각 행 간에 조인 조건을 검사하여 일치하는 행을 결정.
	- 일치하는 행이 발견되면 조인 조건에 따라 결과에 추가됨.
## 적용 상황
- 작은 크기의 테이블을 기준으로 대용량 테이블을 조인해야 할 때 효율적.
- 보통 [[OLTP성 환경의]] 쿼리에서 적절, 대량 테이블 조인하는 방식은 적절하지 않음.
- 외부 테이블의 크기가 내부 테이블보다 작고, 내부 테이블에 인덱스가 존재하지 않을 때 주로 사용.
- 외부 테이블을 스캔하는 횟수는 외부 테이블의 행 수와 동일하며, 내부 테이블을 스캔하는 횟수는 외부 테이블의 행 수와 내부 테이블의 행 수를 곱한 것.
- join 칼럼에 index가 걸려있지 않으면, 한 건씩 전부 Full Scan하기 때문에 내부 반복 테이블의 Index 구성전략이 중요한 요소임.

## 장단점
- 장점
	- 작은 테이블을 기준으로 대용량의 테이블을 조인할 때 효율적.
	- 메모리 사용이 적어 특정 상황에서 메모리 부담이 적음
- 단점
	- 대용량 테이블을 조인할 때 성능이 저하될 수 있음.
	- 외부 테이블의 각 행마다 내부 테이블을 전체 순회하기 때문에 처리 시간이 오래 걸릴 수 있음.


# Sort Merge Join(정렬 병합 조인)
입력 테이블의 크기와 인덱스 유무, 쿼리 조건 등을 고려하여 선택됨.
## 동작 방식
- 중첩 for문과 유사하나, join테이블을 join칼럼 기준으로 정렬하고 나서 join함.
- 두 개의 입력 테이블이 정렬된 상태로 제공되어야 한다. 각 입력 테이블은 조인 조건에 해당하는 열을 기준으로 정렬됨.
- 정렬된 두 테이블을 병합하는 과정에서 각 테이블에서 동일한 조건을 만족하는 행을 찾아 조인.
- 이때 두 테이블이 정렬되어 있어야 하므로, 정렬 작업이 추가되어 성능에 영향을 줄 수 있음.

## 적용 상황
- Inner table에 적절한 Index가 없어서 nested loop join가 적절하지 않을 때 사용.
- 범위로 join하는 경우 적절, Equal join은 적절하지 않음.
- 일반적으로 입력 테이블의 크기가 크고, index를 통한 접근이 적합하지 않을 때 사용.
- 대용량 테이블 간의 조인을 수행할 때 성능이 우수. 특히. 테이블의 크기가 유사하고, 메모리에 한번에 로드할 수 없을 정도로 크지만 디스크에서 직접 읽을 수 있는 크기일 때 적합.
- Table Random Access가 일어나지 않고 정렬 작업이 PGA영역에서 수행되어 경합이 발생하지 않아 성능 유리.

## 장단점
- 장점
	- 대용량 테이블 간의 조인에서 효율적
	- 병렬 처리를 통해 성능을 높일 수 있음.
- 단점
	- 입력 테이블이 정렬되어 있어야해서 정렬 작업이 추가로 필요할 수 있음.
	- 정렬된 상태로 데이터를 유지하는 오버헤드가 발생할 수 있음.
	- 메모리나 디스크 공간에 큰 부하를 줄 수 있음.

# Hash Join
일반적으로 대량의 데이터를 처리할 때 효율적.
옵티마이저가 자동으로 선택

## 동작 방식
1. 해시 테이블 구성
	- 두 테이블 중 일반적으로 작은 테이블을 기준으로 해시 테이블을 생성. 
	- 기준 테이블의 각 행에서 해시 함수를 사용하여 해시 키를 생성하고, 해당 키에 대응하는 버킷에 행을 저장.
2. 해시 테이블 생성
	- 해시 테이블을 생성하는 단계에서는 해시 키가 충돌하는 경우를 처리해야 함. 충돌은 해시 함수가 서로 다른 행에 대해 동일한 해시 키를 생성할 때 발생. 이를 처리하기 위해 충돌 해결 매커니즘이 필요.
3. 조인 수행
	- 다른 테이블(큰 테이블)의 각 행에 대해 동일한 해시 함수를 적용하여 해시 키를 생성.
	- 해당 해시키를 기준으로 해시 테이블에서 해당하는 버킷을 찾아 조인 수행. 즉, 기준 테이블과 일치하는 해시 키를 갖는 행들을 찾아 연결.
-  inner table에 데이터가 너무 많으면 outer table을 build input으로 삼아서 hash영역에 저장.
- sort merge join처럼 Random Access 부하가 없음.

>Random access 
>데이터 저장 및 검색 방법 중 하나를 의미합니다. 이 용어는 특정 위치에 직접 액세스하여 데이터를 읽거나 쓸 수 있는 기능을 설명합니다. 다시 말해, 데이터의 임의의 위치에 접근하여 데이터에 대한 읽기 또는 쓰기 작업을 수행할 수 있습니다.
>일반적으로 데이터베이스에서는 "random access"를 사용하여 데이터를 검색합니다. 이는 특정 레코드나 튜플에 직접 액세스하여 해당 데이터를 가져오는 것을 의미합니다. 이는 데이터베이스 시스템이 색인(Index)을 사용하여 특정 키 값 또는 행 번호를 기반으로 데이터를 검색하는 데 사용됩니다.
>또한 컴퓨터의 파일 시스템에서도 "random access"가 사용됩니다. 파일 시스템은 파일의 특정 위치에 직접 액세스하여 파일의 내용을 읽거나 쓸 수 있도록 합니다. 이는 파일의 크기가 크거나 특정 부분의 수정이 필요할 때 유용합니다.
>"Random access"는 데이터를 순차적으로 읽거나 쓰는 것과 대조적입니다. 순차 액세스는 데이터를 처음부터 순서대로 읽거나 쓰는 것을 의미합니다. 일반적으로 "random access"는 데이터베이스나 파일 시스템과 같은 대규모 데이터 저장소에서 빠른 검색 및 수정을 지원하기 위해 사용됩니다.

## 적용 상황
- 대용량의 두 테이블을 조인할 때 효율적.
- Equal join만 가능.
- 일반적으로 작은 테이블을 기준으로 해시 테이블을 생성하므로, 작은 테이블의 크기가 클 때 효과적.
- 해시 조인은 주로 OLAP(online analytical processing)환경에서 사용되며, 데이터 웨어하우스 및 분석 쿼리에 유용.
- 해시 영역으로 올라갈 때 join 칼럼기준으로 hash function이 적용되어 key 칼럼에 중복 값이 없을수록 성능에 유리함.
- 유의점
	- 해시 영역에 올라가는 테이블의 크기가 충분히 작아야 유리함. 해시영역 크리보다 테이블 용량이 크면 디스크 영역을 사용하게 되어 성능 저하됨.
	- 수행 빈도가 높은 OLTP환경에서 해시조인을 사용하면 CPU, 메모리 사용량이 늘어 성능저하되므로, 실행계획을 꼭 확인후 해시로 풀리면 힌트 사용하여 다른 수행방식을 쓰도록 해야함.

## 장단점
- 장점
	- 대용량 데이터를 효율적으로 처리
	- 병렬 처리에 적합하여 성능 향상
- 단점
	- 해시 테이블을 생성하기 위한 추가적인 메모리 공간이 필요
	- 충돌 처리 과정에서 오버헤드 발생할 수 있음.

>해시 함수
>임의의 크기의 데이터를 받아서 고정된 크기의 데이터로 변환하는 함수입니다. 이러한 함수는 해시 알고리즘을 사용하여 데이터를 해시 값으로 매핑합니다.

# DB 메모리 구성 요소
데이터베이스의 메모리를 관리하고, 데이터베이스 작업 및 성능에 영향을 줌.
## 1.PGA(Program Global Area) : 개별 사용자의 작업에 관련된 메모리 관리
- PGA는 개별 세션 또는 사용자의 작업에 필요한 메모리를 저장하는 영역.
- 각 사용자의 세션마다 별도의 PGA가 생성됨.
- PGA는 SQL 문을 파싱, 실행 및 최적화하는데 사용되는 메모리, 정렬 작업을 위한 임시공간, 데이터 조작 및 정렬을 위한 공간 등을 포함.
- 사용자의 작업이 완료되면 해당 PGA는 해제되어 메모리를 반환함.

## 2.SGA(System Global Area) : 모든 사용자가 공유하는 데이터베이스 자원 관
- SGA는 Oracle인스턴스 전반에 걸쳐 모든 세션 또는 사용자가 공유하는 메모리를 저장하는 영역.
- 데이터베이스 캐시, 공유 풀, 로그 버퍼, 공유 SQL 영역 등의 구성 요소를 포함.
- 데이터베이스의 전반적인 성능에 영향을 미치는 중요한 부분으로, 데이터베이스의 모든 사용자가 공유하여 사용.
- SGA는 인스턴스가 시작될 때 할당되며, 인스턴스가 종료될 때까지 메모리를 유지함.

# 컴퓨팅 용어
## 해시 영역(Hash Area)
- 해시 영역은 주로 컴퓨터 메모리 내에 할당되는 영역을 가리킵니다. 이는 해시 테이블을 구성하거나 해시 함수를 실행하는 데 사용될 수 있습니다.
- 해시 테이블은 해시 함수에 따라 해시 값과 해당 값에 대응하는 데이터를 저장하는 자료구조입니다. 해시 테이블은 일반적으로 해시 충돌을 해결하기 위한 충돌 해결 메커니즘을 포함합니다.
- 해시 영역은 주로 알고리즘의 실행 중에 임시 데이터를 저장하거나 해싱 연산을 수행하는 데 사용됩니다.
## 디스크 영역(Disk Area)
- 디스크 영역은 컴퓨터의 저장 장치인 디스크에 할당되는 영역을 의미합니다. 이는 주로 파일 시스템에 저장된 데이터를 가리키는 데 사용됩니다.
- 디스크 영역은 주로 파일이나 디렉터리 등의 데이터를 저장하는 데 사용됩니다. 파일 시스템은 이러한 데이터를 디스크에 쓰고 읽는 데 사용되는 메커니즘을 제공합니다.
- 디스크 영역은 보통 주기억장치인 RAM보다 훨씬 큰 용량을 갖고 있으며, 영구적인 데이터 보존을 위해 사용됩니다.

### 두 영역의 차이점
- 해시 영역과 디스크 영역의 가장 큰 차이점은 데이터가 저장되는 위치입니다. 
- 해시 영역은 주로 주기억장치인 RAM에 데이터를 저장하고 처리하는 데 사용됩니다. 
- 반면에 디스크 영역은 주로 보조기억장치인 디스크에 데이터를 저장하고 파일 시스템을 통해 접근하는 데 사용됩니다. 
- 따라서 해시 영역은 주로 임시적이고 빠른 데이터 처리를 위해 사용되고, 디스크 영역은 영구적인 데이터 저장 및 검색을 위해 사용됩니다.

## OLTP()

## 