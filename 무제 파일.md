## 마일스톤
- TASK 가시화가 목표. 프로젝트의 주요 단계, 목표 설정
- 1.초기 설정 및 ERD 설계
	- 프로젝트 기본 설정
	- My SQL DB설정
	- ERD설계
	- 시퀀스 다이어그램 설계
	- 플로우차트 생성
- 2.기본 API구현
	- API 명세
		- 잔액 충전 / 조회 API (CRU)
		- 예약 가능 날짜/좌석 조회 API (R)
		- 유저 토큰 발급 (CRUD)
		- 좌석 예약 요청 (CR)
		- 결제 (C)
	- Mock API 명세
- 3.API 고도화
- 4.테스트
	- 유닛 테스트 / 통합 테스트 작성
	- Mock API 테스트 작성
- 5.배포 및 최종 검토
	- 배포
	- 성능 테스트 및 최종 점검

#### 시퀀스 다이어그램 
시스템 내에서 객체들이 상호 작용하는 흐름을 보여줌.
하나의 시나리오를 사용자, 시스템, DB간 상호작용으로 그림
- 구성요소 
	- 객체 : 사용자, API, 데이터베이스
	- 메서지 : 요청, 응답, 데이터 베이스 조회 등
#### 플로우차트 
예약 과정의 흐름과 조건을 시각적으로 표현.
로직의 조건흐름을 구성.
- 구성요소
	- 시작/종료 : 사용자 요청, 응답
	- 조건 : 좌석 수, 중복예약여부
	- 처리 : 예약처리, 실패 처리

#### API명세
외부시스템과의 상호작용을 정의하는 문서.
- 구성요소
	- url
	- 설명
	- 응답

#### Mock API 명세
실제 구현 전, 프론트엔드와 연동을 위해 가상으로 정의하는 API
실제 DB와 연결되기 전까지 Mock API로 클라이언트와 테스트 할 수 있음.
- 구성요소
	- 요청 본문
	- 응답

#### ERD설계 
데이터베이스 테이블 간의 관계를 정의
```
CREATE TABLE tb_user (
    user_id BIGINT AUTO_INCREMENT PRIMARY KEY COMMENT '사용자의 고유 식별자',
    username VARCHAR(100) NOT NULL COMMENT '사용자의 이름',
    email VARCHAR(255) NOT NULL UNIQUE COMMENT '사용자의 이메일',
    balance DECIMAL(10, 2) NOT NULL DEFAULT 0.00 COMMENT '사용자의 잔액',
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '사용자 계정 생성일'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='사용자 테이블';

CREATE TABLE tb_concert (
    concert_id BIGINT AUTO_INCREMENT PRIMARY KEY COMMENT '콘서트 고유 식별자',
    title VARCHAR(200) NOT NULL COMMENT '콘서트 제목',
    description TEXT COMMENT '콘서트 설명',
    date DATETIME NOT NULL COMMENT '콘서트 날짜 및 시간',
    capacity INT NOT NULL COMMENT '콘서트 정원',
    price DECIMAL(10, 2) NOT NULL COMMENT '콘서트 예약 금액',
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '콘서트 정보 생성일'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='콘서트 테이블';

CREATE TABLE tb_reservation (
    reservation_id BIGINT AUTO_INCREMENT PRIMARY KEY COMMENT '예약 고유 식별자',
    concert_id BIGINT NOT NULL COMMENT '예약한 콘서트 ID',
    user_id BIGINT NOT NULL COMMENT '예약한 사용자 ID',
    reserved_at DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '예약 시간',
    UNIQUE KEY uniq_concert_user (concert_id, user_id) COMMENT '중복 예약 방지를 위한 유니크 제약',
    INDEX idx_concert_id (concert_id),
    INDEX idx_user_id (user_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='예약 테이블';


CREATE TABLE tb_user_balance_log (
    log_id BIGINT AUTO_INCREMENT PRIMARY KEY COMMENT '잔액 변경 로그 ID',
    user_id BIGINT NOT NULL COMMENT '잔액 변경 대상 사용자 ID',
    amount DECIMAL(10, 2) NOT NULL COMMENT '변경된 금액 (양수: 충전, 음수: 차감)',
    log_type ENUM('충전', '예약') NOT NULL COMMENT '변경 유형 (충전 또는 예약)',
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '변경 로그 생성 시간',
    INDEX idx_user_id (user_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='사용자 잔액 변경 내역 테이블';

CREATE TABLE tb_user_token (
    token_id BIGINT AUTO_INCREMENT PRIMARY KEY COMMENT '토큰 고유 식별자',
    user_id BIGINT NOT NULL COMMENT '토큰이 발급된 사용자 ID',
    token_uuid CHAR(36) NOT NULL UNIQUE COMMENT '유저 고유 토큰 (UUID)',
    queue_id BIGINT COMMENT '연결된 대기열 항목 ID (대기열 토큰)',
    issued_at DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '토큰 발급 시간',
    expires_at DATETIME COMMENT '토큰 만료 시간',
    INDEX idx_user_id (user_id),
    INDEX idx_queue_id (queue_id),
    INDEX idx_expires_at (expires_at)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='유저 토큰 관리 테이블';

CREATE TABLE tb_waiting_queue (
    queue_id BIGINT AUTO_INCREMENT PRIMARY KEY COMMENT '대기열 항목 고유 식별자',
    concert_id BIGINT NOT NULL COMMENT '대기열이 적용된 콘서트 ID',
    user_id BIGINT NOT NULL COMMENT '대기열에 등록된 사용자 ID',
    queued_at DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '대기열 등록 시간',
    status ENUM('WAITING', 'EXPIRED', 'CONFIRMED') NOT NULL DEFAULT 'WAITING' COMMENT '대기 상태',
    UNIQUE KEY uniq_concert_user (concert_id, user_id) COMMENT '대기열 중복 방지를 위한 유니크 제약',
    INDEX idx_queued_at (queued_at),
    INDEX idx_concert_id_status (concert_id, status)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='대기열 테이블';

CREATE TABLE tb_seat_reservation (
    seat_id BIGINT AUTO_INCREMENT PRIMARY KEY COMMENT '좌석 고유 식별자',
    concert_id BIGINT NOT NULL COMMENT '콘서트 ID',
    seat_number VARCHAR(10) NOT NULL COMMENT '좌석 번호',
    user_id BIGINT COMMENT '임시 배정된 사용자 ID',
    reserved_at DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '임시 배정 시작 시간',
    reserved_until DATETIME COMMENT '임시 배정 만료 시간',
    status ENUM('AVAILABLE', 'TEMPORARY', 'CONFIRMED') NOT NULL DEFAULT 'AVAILABLE' COMMENT '좌석 상태',
    UNIQUE KEY uniq_concert_seat (concert_id, seat_number) COMMENT '콘서트별 좌석 중복 방지를 위한 유니크 제약',
    INDEX idx_concert_id (concert_id),
    INDEX idx_user_id (user_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='좌석 예약 테이블';

CREATE INDEX idx_seat_reservation_concert ON tb_seat_reservation (concert_id);
CREATE INDEX idx_seat_reservation_status ON tb_seat_reservation (status);
CREATE INDEX idx_seat_reservation_concert_status ON tb_seat_reservation (concert_id, status);


```


https://github.com/han-chunsik/hhplus-service/wiki/%EC%84%A4%EA%B3%84-%7C-%ED%8C%A8%ED%82%A4%EC%A7%80-%EA%B5%AC%EC%A1%B0#%ED%8C%A8%ED%82%A4%EC%A7%80-%EA%B5%AC%EC%A1%B0

https://github.com/ara-zo/server-construction-03/pull/26/commits/c1a1df5faa708537395bf0f44de82e66fd36d0ae?short_path=62eb648#diff-62eb648eac8e8fd6959e08e5ba9a87bf75b83ee76e78dcad7225b693365671f3